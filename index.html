<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONFIIA | Estudio de Confianza en IA Cl√≠nica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,400;0,8..60,600;0,8..60,700;1,8..60,400&family=Inter:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ========================================
           CONFIIA Survey v2 - Premium Design
           ======================================== */
        :root {
            --color-bg: #0a0a0f;
            --color-bg-elevated: #12121a;
            --color-bg-card: #1a1a24;
            --color-text: #f5f5f7;
            --color-text-secondary: #a1a1aa;
            --color-text-muted: #71717a;
            --color-accent: #6366f1;
            --color-accent-light: #818cf8;
            --color-accent-glow: rgba(99, 102, 241, 0.15);
            --color-success: #10b981;
            --color-border: rgba(255, 255, 255, 0.08);
            
            --font-display: 'Source Serif 4', Georgia, serif;
            --font-body: 'Inter', sans-serif;
            --font-mono: 'Space Mono', monospace;
            
            --radius-md: 12px;
            --radius-lg: 20px;
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: var(--font-body);
            background: var(--color-bg);
            color: var(--color-text);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Background Effects */
        .bg-gradient { position: fixed; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; z-index: 0; }
        .bg-gradient::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(ellipse at 30% 20%, rgba(99, 102, 241, 0.08) 0%, transparent 50%),
                        radial-gradient(ellipse at 70% 80%, rgba(139, 92, 246, 0.06) 0%, transparent 50%);
            animation: bgShift 20s ease-in-out infinite;
        }
        @keyframes bgShift { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(-5%, 5%); } }
        
        .grid-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; z-index: 0;
            background-image: linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 60px 60px;
            mask-image: radial-gradient(ellipse at center, black 0%, transparent 70%);
        }

        /* Header */
        .header { position: fixed; top: 0; left: 0; right: 0; z-index: 100; padding: 1.25rem 2rem; display: flex; justify-content: space-between; align-items: center; background: linear-gradient(to bottom, var(--color-bg) 0%, transparent 100%); }
        .logo { display: flex; align-items: center; gap: 0.75rem; }
        .logo-mark { width: 36px; height: 36px; background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-family: var(--font-mono); font-weight: 700; font-size: 0.875rem; }
        .logo-text { font-family: var(--font-mono); font-size: 0.75rem; letter-spacing: 0.1em; color: var(--color-text-secondary); text-transform: uppercase; }
        .header-meta { font-family: var(--font-mono); font-size: 0.6875rem; color: var(--color-text-muted); letter-spacing: 0.05em; }

        /* Main */
        .main { position: relative; z-index: 1; min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 6rem 1.5rem 3rem; }
        .screen { display: none; width: 100%; max-width: 640px; animation: screenIn 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        .screen.active { display: block; }
        @keyframes screenIn { from { opacity: 0; transform: translateY(30px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }

        .card { background: var(--color-bg-card); border: 1px solid var(--color-border); border-radius: var(--radius-lg); padding: 2rem; }
        .welcome-title { font-family: var(--font-display); font-size: clamp(2.5rem, 7vw, 4rem); font-weight: 600; line-height: 1.1; margin-bottom: 1.5rem; }
        .welcome-title .highlight { background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 50%, #c084fc 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .welcome-description { font-size: 1.125rem; color: var(--color-text-secondary); margin-bottom: 2rem; }

        /* Buttons & Forms */
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.6rem; font-family: var(--font-body); font-size: 0.93rem; font-weight: 500; padding: 1rem 2rem; border-radius: var(--radius-md); border: none; cursor: pointer; transition: all var(--transition); text-decoration: none; }
        .btn-primary { background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%); color: white; box-shadow: 0 4px 20px rgba(99, 102, 241, 0.3); }
        .btn-secondary { background: var(--color-bg-card); color: var(--color-text); border: 1px solid var(--color-border); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .form-input, .form-select { font-family: var(--font-body); font-size: 0.93rem; padding: 0.87rem 1rem; background: var(--color-bg-elevated); border: 1px solid var(--color-border); border-radius: 8px; color: var(--color-text); width: 100%; margin-bottom: 1rem; }
        
        /* Role & Options */
        .role-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; }
        .role-card { padding: 1.5rem; background: var(--color-bg-elevated); border: 2px solid var(--color-border); border-radius: var(--radius-md); cursor: pointer; text-align: center; }
        .role-card.selected { border-color: var(--color-accent); background: var(--color-accent-glow); }
        .role-card input { display: none; }

        .likert-scale { display: flex; justify-content: space-between; gap: 0.5rem; margin-top: 1rem; }
        .likert-btn { width: 100%; max-width: 60px; aspect-ratio: 1; display: flex; align-items: center; justify-content: center; background: var(--color-bg-elevated); border: 2px solid var(--color-border); border-radius: 8px; cursor: pointer; }
        .likert-option input { display: none; }
        .likert-option input:checked + .likert-btn { background: var(--color-accent); border-color: var(--color-accent); color: white; }

        .progress-bar { height: 4px; background: var(--color-bg-elevated); border-radius: 2px; margin: 1rem 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--color-accent) 0%, var(--color-accent-light) 100%); width: 0%; transition: width 0.4s ease; }

        .hidden { display: none !important; }
        .nav-buttons { display: flex; justify-content: space-between; gap: 1rem; margin-top: 1.5rem; }
        
        /* Loading */
        .btn.loading { color: transparent; pointer-events: none; position: relative; }
        .btn.loading::after { content: ''; position: absolute; width: 20px; height: 20px; border: 2px solid transparent; border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; left: 50%; top: 50%; margin-left: -10px; margin-top: -10px; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .footer { position: fixed; bottom: 0; left: 0; right: 0; padding: 1rem 2rem; display: flex; justify-content: space-between; font-size: 0.68rem; color: var(--color-text-muted); background: linear-gradient(to top, var(--color-bg) 0%, transparent 100%); }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>
    <div class="grid-overlay"></div>

    <header class="header">
        <div class="logo">
            <div class="logo-mark">C</div>
            <span class="logo-text">Universidad Pontificia de Comillas y Universidad de Granada</span>
        </div>
        <div class="header-meta">Protocolo CONFIIA</div>
    </header>

    <main class="main">
        <section class="screen active" id="screen-welcome">
            <div style="margin-bottom: 2rem;">
                <span style="background: var(--color-accent-glow); color: var(--color-accent-light); padding: 0.5rem 1rem; border-radius: 100px; font-size: 0.7rem; font-weight: 500; text-transform: uppercase; letter-spacing: 0.08em; border: 1px solid rgba(99,102,241,0.2);">Estudio de Investigaci√≥n</span>
            </div>
            <h1 class="welcome-title">Confianza en<br><span class="highlight">Inteligencia Artificial</span><br>Cl√≠nica</h1>
            <p class="welcome-description">Estudio cient√≠fico sobre las actitudes de profesionales sanitarios y ciudadanos hacia el uso de sistemas de IA en decisiones cl√≠nicas.</p>
            <div style="display: flex; gap: 1.5rem; margin-bottom: 3rem; padding: 1.25rem; background: var(--color-bg-card); border: 1px solid var(--color-border); border-radius: 12px;">
                <span style="font-size: 0.9rem; color: var(--color-text-secondary);">‚è± 5-7 minutos</span>
                <span style="font-size: 0.9rem; color: var(--color-text-secondary);">üîí 100% an√≥nimo</span>
            </div>
            <button class="btn btn-primary" onclick="nextScreen()">Comenzar estudio</button>
        </section>

        <section class="screen" id="screen-consent">
            <div class="card">
                <h2 style="font-family: var(--font-display); font-size: 1.75rem; margin-bottom: 1.5rem;">Consentimiento Informado</h2>
                <div style="margin-bottom: 1.5rem; color: var(--color-text-secondary); font-size: 0.9rem;">
                    <p style="margin-bottom: 1rem;">Este estudio tiene como objetivo desarrollar un instrumento para medir la confianza en IA sanitaria.</p>
                    <p>Sus respuestas son completamente an√≥nimas y se utilizar√°n exclusivamente con fines de investigaci√≥n.</p>
                </div>
                <label class="checkbox-wrapper" style="display: flex; gap: 1rem; cursor: pointer; padding: 1rem; background: var(--color-bg-elevated); border-radius: 12px; border: 1px solid var(--color-border);">
                    <input type="checkbox" id="consent-check" onchange="validateConsent()">
                    <span style="font-size: 0.9rem; color: var(--color-text-secondary);">He le√≠do y acepto participar voluntariamente.</span>
                </label>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevScreen()">Atr√°s</button>
                    <button class="btn btn-primary" id="btn-consent-next" onclick="nextScreen()" disabled>Continuar</button>
                </div>
            </div>
        </section>

        <section class="screen" id="screen-demographics">
            <div class="card">
                <h2 style="font-family: var(--font-display); font-size: 1.75rem; margin-bottom: 1.5rem;">Datos Sociodemogr√°ficos</h2>
                <form id="demographics-form">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.8rem; font-weight: 500;">¬øCu√°l es su perfil?</label>
                        <div class="role-grid">
                            <label class="role-card">
                                <input type="radio" name="role" value="profesional" onchange="updateRole(this)">
                                <div style="font-weight: 600; margin-bottom: 0.25rem;">Profesional Sanitario</div>
                                <div style="font-size: 0.75rem; color: var(--color-text-muted);">M√©dico/a, enfermero/a...</div>
                            </label>
                            <label class="role-card">
                                <input type="radio" name="role" value="ciudadano" onchange="updateRole(this)">
                                <div style="font-weight: 600; margin-bottom: 0.25rem;">Ciudadano/a</div>
                                <div style="font-size: 0.75rem; color: var(--color-text-muted);">Paciente o general</div>
                            </label>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <input type="number" name="age" placeholder="Edad" class="form-input" required>
                        </div>
                        <div>
                            <select name="sex" class="form-select" required>
                                <option value="">Sexo...</option>
                                <option value="mujer">Mujer</option>
                                <option value="hombre">Hombre</option>
                                <option value="otro">Otro</option>
                            </select>
                        </div>
                    </div>

                    <div class="professional-only hidden">
                        <select name="profession" class="form-select">
                            <option value="">Profesi√≥n...</option>
                            <option value="medicina">Medicina</option>
                            <option value="enfermeria">Enfermer√≠a</option>
                            <option value="psicologia">Psicolog√≠a</option>
                            <option value="otra">Otra</option>
                        </select>
                        <input type="number" name="experience" placeholder="A√±os experiencia" class="form-input">
                    </div>

                    <div style="margin-top: 1rem;">
                        <label style="font-size: 0.8rem;">Familiaridad con IA (1-5)</label>
                        <div class="likert-scale">
                            <label class="likert-option"><input type="radio" name="ai_familiarity" value="1"><span class="likert-btn">1</span></label>
                            <label class="likert-option"><input type="radio" name="ai_familiarity" value="2"><span class="likert-btn">2</span></label>
                            <label class="likert-option"><input type="radio" name="ai_familiarity" value="3"><span class="likert-btn">3</span></label>
                            <label class="likert-option"><input type="radio" name="ai_familiarity" value="4"><span class="likert-btn">4</span></label>
                            <label class="likert-option"><input type="radio" name="ai_familiarity" value="5"><span class="likert-btn">5</span></label>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1rem;">
                        <label style="font-size: 0.8rem;">¬øHa usado IA en contextos cl√≠nicos?</label>
                        <select name="ai_clinical_use" class="form-select">
                            <option value="">Seleccione...</option>
                            <option value="si">S√≠</option>
                            <option value="no">No</option>
                            <option value="no_seguro">No estoy seguro/a</option>
                        </select>
                    </div>
                </form>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevScreen()">Atr√°s</button>
                    <button class="btn btn-primary" onclick="validateDemographics()">Continuar</button>
                </div>
            </div>
        </section>

        <section class="screen" id="screen-instructions">
            <div class="card">
                <h2 style="font-family: var(--font-display); font-size: 1.75rem; margin-bottom: 1.5rem;">Instrucciones</h2>
                <p style="color: var(--color-text-secondary); margin-bottom: 1.5rem;">A continuaci√≥n ver√° 6 situaciones hipot√©ticas. Indique la probabilidad de actuar como se describe.</p>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevScreen()">Atr√°s</button>
                    <button class="btn btn-primary" onclick="nextScreen()">Comenzar</button>
                </div>
            </div>
        </section>

        <section class="screen" id="screen-items">
            <div class="card">
                <div style="display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--color-text-muted); text-transform: uppercase;">
                    <span>Progreso</span>
                    <span id="progress-text">1 / 6</span>
                </div>
                <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
                <div id="items-container" style="min-height: 250px;"></div>
                <div class="nav-buttons">
                    <button class="btn btn-secondary" id="btn-prev-item" onclick="prevItem()" style="visibility: hidden;">Anterior</button>
                    <button class="btn btn-primary" id="btn-next-item" onclick="nextItem()" disabled>Siguiente</button>
                </div>
            </div>
        </section>

        <section class="screen" id="screen-end">
            <div class="card text-center">
                <div style="width: 80px; height: 80px; margin: 0 auto 2rem; display: flex; align-items: center; justify-content: center; background: rgba(16,185,129,0.1); border-radius: 50%; color: #10b981;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="40" height="40"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                </div>
                <h2 style="font-family: var(--font-display); font-size: 2rem; margin-bottom: 1rem;">¬°Gracias por participar!</h2>
                <p style="color: var(--color-text-secondary); margin-bottom: 2rem;">Sus respuestas han sido registradas correctamente. Su contribuci√≥n es valiosa para la investigaci√≥n.</p>
                <a href="https://anibalmastobiza.github.io/CONFIIA/" class="btn btn-secondary">Volver al inicio</a>
            </div>
        </section>
    </main>

    <footer class="footer">
        <span>¬© 2025 Proyecto CONFIIA</span>
        <span>Universidad Pontificia de Comillas y Universidad de Granada</span>
    </footer>

    <script>
        // CONFIGURACI√ìN (URL sincronizada con tu app.js)
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzJEY-s_3onfo57Gp4mS43V5tEFS6kIyxPRWKfqvYJmZO7SXaBtw5kXXuc4jZUZkAxgtg/exec';

        const ITEMS_PROFESSIONAL = [
            { id: 'P1', dimension: 'Innovaci√≥n-tradici√≥n', text: '¬øSeguir√≠a una recomendaci√≥n innovadora de la IA frente a una tradicional si ambas son cl√≠nicamente plausibles?', reverse: true },
            { id: 'P2', dimension: 'Explicabilidad-riesgo', text: '¬øAprobar√≠a una recomendaci√≥n agresiva de la IA si su justificaci√≥n no es explicable con claridad cl√≠nica?', reverse: true },
            { id: 'P3', dimension: 'Consenso experto', text: '¬øImplementar√≠a una pauta personalizada generada por IA para un caso complejo, si el equipo cl√≠nico est√° convencido?', reverse: false },
            { id: 'P4', dimension: 'Consenso experto (inverso)', text: '¬øImplementar√≠a la misma pauta si el equipo cl√≠nico se muestra esc√©ptico?', reverse: true },
            { id: 'P5', dimension: 'Supervisi√≥n humana', text: '¬øDelegar√≠a una decisi√≥n cl√≠nica cr√≠tica en una IA supervisada por humanos?', reverse: false },
            { id: 'P6', dimension: 'Autonom√≠a plena', text: '¬øDelegar√≠a una decisi√≥n cl√≠nica cr√≠tica en una IA sin supervisi√≥n humana?', reverse: true }
        ];

        const ITEMS_CITIZEN = [
            { id: 'C1', dimension: 'Explicabilidad-riesgo', text: '¬øAceptar√≠a un plan de tratamiento agresivo propuesto por la IA si no puede ser explicado con claridad por su m√©dico?', reverse: true },
            { id: 'C2', dimension: 'Innovaci√≥n-tradici√≥n', text: '¬øPreferir√≠a una recomendaci√≥n tradicional frente a una innovadora de IA para su tratamiento?', reverse: false },
            { id: 'C3', dimension: 'Consenso experto', text: '¬øSe sentir√≠a c√≥modo/a si el equipo cl√≠nico est√° convencido y respalda una decisi√≥n guiada por IA?', reverse: false },
            { id: 'C4', dimension: 'Supervisi√≥n humana', text: '¬øConfiar√≠a en una IA supervisada por humanos para decidir su pauta de tratamiento?', reverse: false },
            { id: 'C5', dimension: 'Autonom√≠a plena', text: '¬øConfiar√≠a en una IA no supervisada para decidir su pauta de tratamiento?', reverse: true },
            { id: 'C6', dimension: 'Autonom√≠a comunicativa', text: '¬øUtilizar√≠a un chatbot de IA para recibir un diagn√≥stico sin ver antes a un m√©dico?', reverse: true }
        ];

        const state = {
            currentScreen: 0,
            currentItem: 0,
            participantId: null,
            startTime: null,
            role: null,
            items: [],
            responses: { consent: false, demographics: {}, items: {} }
        };

        const screens = ['screen-welcome', 'screen-consent', 'screen-demographics', 'screen-instructions', 'screen-items', 'screen-end'];

        document.addEventListener('DOMContentLoaded', () => {
            state.participantId = `CONFIIA-${Date.now().toString(36)}-${Math.random().toString(36).substring(2, 8)}`.toUpperCase();
            state.startTime = new Date().toISOString();
        });

        function nextScreen() {
            document.getElementById(screens[state.currentScreen]).classList.remove('active');
            state.currentScreen++;
            document.getElementById(screens[state.currentScreen]).classList.add('active');
            if (screens[state.currentScreen] === 'screen-items') initializeItems();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function prevScreen() {
            document.getElementById(screens[state.currentScreen]).classList.remove('active');
            state.currentScreen--;
            document.getElementById(screens[state.currentScreen]).classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function validateConsent() {
            document.getElementById('btn-consent-next').disabled = !document.getElementById('consent-check').checked;
        }

        function updateRole(input) {
            document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
            input.closest('.role-card').classList.add('selected');
            state.role = input.value;
            state.items = state.role === 'profesional' ? ITEMS_PROFESSIONAL : ITEMS_CITIZEN;
            document.querySelectorAll('.professional-only').forEach(f => f.classList.toggle('hidden', state.role !== 'profesional'));
        }

        function validateDemographics() {
            const fd = new FormData(document.getElementById('demographics-form'));
            if (!fd.get('role') || !fd.get('age') || !fd.get('sex') || !fd.get('ai_familiarity') || !fd.get('ai_clinical_use')) {
                alert('Por favor, complete todos los campos obligatorios.'); return;
            }
            state.responses.demographics = Object.fromEntries(fd.entries());
            nextScreen();
        }

        function initializeItems() {
            const container = document.getElementById('items-container');
            container.innerHTML = state.items.map((item, i) => `
                <div class="item-card ${i === 0 ? 'active' : ''}" id="item-${i}">
                    <div class="item-dimension">${item.dimension}</div>
                    <p class="item-question">${item.text}</p>
                    <div class="likert-container">
                        <div class="likert-labels"><span>Muy improbable</span><span>Muy probable</span></div>
                        <div class="likert-scale">
                            ${[1,2,3,4].map(v => `<label class="likert-option"><input type="radio" name="item-${item.id}" value="${v}" onchange="handleResponse('${item.id}', ${v})"><span class="likert-btn">${v}</span></label>`).join('')}
                        </div>
                    </div>
                </div>`).join('');
            updateProgress();
        }

        function handleResponse(itemId, value) {
            state.responses.items[itemId] = value;
            document.getElementById('btn-next-item').disabled = false;
        }

        function nextItem() {
            if (state.currentItem < state.items.length - 1) {
                state.currentItem++;
                document.querySelectorAll('.item-card').forEach((c, i) => c.classList.toggle('active', i === state.currentItem));
                document.getElementById('btn-prev-item').style.visibility = 'visible';
                document.getElementById('btn-next-item').disabled = !state.responses.items[state.items[state.currentItem].id];
                updateProgress();
            } else {
                submitData();
            }
        }

        function prevItem() {
            if (state.currentItem > 0) {
                state.currentItem--;
                document.querySelectorAll('.item-card').forEach((c, i) => c.classList.toggle('active', i === state.currentItem));
                document.getElementById('btn-prev-item').style.visibility = state.currentItem === 0 ? 'hidden' : 'visible';
                updateProgress();
            }
        }

        function updateProgress() {
            const pct = ((state.currentItem + 1) / state.items.length) * 100;
            document.getElementById('progress-fill').style.width = `${pct}%`;
            document.getElementById('progress-text').textContent = `${state.currentItem + 1} / ${state.items.length}`;
        }

        async function submitData() {
            const payload = {
                participant_id: state.participantId,
                start_time: state.startTime,
                end_time: new Date().toISOString(),
                ...state.responses.demographics,
                ...state.responses.items
            };

            const btn = document.getElementById('btn-next-item');
            btn.classList.add('loading'); btn.disabled = true;

            try {
                // ENV√çO REAL SIN RESTRICCIONES
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(payload)
                });
                nextScreen();
            } catch (e) {
                console.error(e);
                alert('Error de conexi√≥n. Int√©ntelo de nuevo.');
                btn.classList.remove('loading'); btn.disabled = false;
            }
        }
    </script>
</body>
</html>
